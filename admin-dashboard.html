<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>لوحة المدرب</title>
  <link rel="stylesheet" href="assets/style.css">
</head>
<body>
<div class="container">
  <div class="topbar">
    <div class="brand">لوحة المدرب</div>
    <div class="actions">
      <button class="btn" onclick="exitAdminMode()">خروج المدرب</button>
    </div>
  </div>

  <div class="card">
    <div class="h2">اختيار المقرر والشعبة</div>
    <div class="grid" style="margin-top:12px">
      <select id="course"></select>
      <select id="section"></select>
    </div>

    <div class="row" style="margin-top:12px">
      <button class="btn primary" onclick="applySel()">تطبيق</button>
      <div id="selMsg" class="muted"></div>
    </div>

    <div class="row" style="margin-top:12px">
      <a class="btn" href="attendance.html">سجل الحضور</a>
      <a class="btn" href="grades.html">سجل الدرجات</a>
      <a class="btn" href="plan.html">خطة المقرر</a>
      <a class="btn" href="policies.html">سياسات المقرر</a>
      <a class="btn" href="calendar.html">التذكيرات</a>
      <a class="btn" href="contact.html">بيانات التواصل</a>
    </div>
  </div>

  <div class="card">
    <div class="h2">إضافة مقرر/شعبة (إلى شيت Course)</div>
    <div class="grid" style="margin-top:12px">
      <input id="newCourse" class="input" placeholder="Course مثال: INET111">
      <input id="newSection" class="input" placeholder="Section مثال: INET111 2">
    </div>
    <div class="row" style="margin-top:12px">
      <button class="btn primary" onclick="addCourse()">إضافة</button>
      <div id="addMsg" class="muted"></div>
    </div>
  </div>
</div>

<script src="assets/app.js"></script>
<script>
async function init(){
  if (!isAdmin()) location.href="admin-login.html";
  await loadAdminCourses(course, section);
}
function applySel(){
  setSelection(course.value, section.value);
  selMsg.textContent = `تم الحفظ: ${course.value} — ${section.value}`;
}
async function addCourse(){
  addMsg.textContent = "جاري الإضافة...";
  try{
    await api("admin_course_add", { course: newCourse.value, section: newSection.value });
    addMsg.textContent = "تمت الإضافة ✅";
    newCourse.value = ""; newSection.value = "";
    await loadAdminCourses(course, section);
  }catch(e){
    addMsg.textContent = e.message || "فشل";
  }
}
init().catch(e=>alert(e.message||e));
</script>
</body>
</html>
